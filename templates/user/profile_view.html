{% extends 'base.html' %}

{% block title %} {{ view.kwargs.username }} | Techwit {% endblock %}
{% block content %}
{% include 'techsite/alerts.html' %}

<div class="container">
    <div class="row">
        <div class="col-md-6">
            <div class="mt-4">
                <div class="d-flex justify-content-center h-100">
                    <div class="box-element mt-2 mb-2">
                        <div class="row">
                            <div class="col-6">
                                <img class="rounded-circle account-img mt-2" src="{{ user.profile.profile_pic.url }}" width="150" height="150" alt="">
                            </div>
                            <div class="col-6">
                                <div class="ml-4">
                                    {% if request.user == user %}
                                    <div class="center mt-2">
                                        <a class="btn btn-outline-secondary tf btn-block" href="{% url 'profile_update' %}">Update Profile</a>
                                    </div>
                                    <div class="center mt-2">
                                        <a class="btn btn-outline-dark mt-2 tf btn-block" href="{% url 'favourite_posts_view' %}">Favourites</a>
                                    </div>
                                    <hr>
                                    {% endif %}
                                </div>  
                            </div>
                        </div>
                        
                        <div class="media-body mt-4">
                            <hr>
                            <h6 class="account-heading">Username: {{ user.username }}</h6>
                            <p class="text-secondary"><h6>Full Name: {{ user.profile.first_name }} {{ user.profile.last_name }}</h6></p>
                            <hr>
                            <p class="text-secondary"><h6>Bio:</h6></p>
                            <p class="text-secondary">{{ user.profile.bio|linebreaks|urlizetrunc:40 }}</p>
                            <hr>
                            <p class="text-secondary"><h6>Email: {{ user.email }}</h6></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-6 mt-2">
            <div class="mb-2 mt-4">
                <div class="infinite-container">
                    {% for forum in object_list %}
                    <div class="media content-section article-text m-2 infinite-item">
                        <div>
                            <img class="rounded-circle  article-img" src="{{ forum.author.profile.profile_pic.url }}" width="70" height="70" alt="">
                        </div>
                        <div class="media-body article-text">
                            <div class="article-metadata">
                                <a class="mr-2" href="{% url 'profile_view' forum.author.username %}">{{ forum.author }}</a>
                                <small class="text-muted">{{ forum.created_date }}</small>
                                |
                                <a href="{{ forum.section.get_absolute_url }}">{{ forum.section }}</a>
                            </div>
                            <div>
                                <h5><a class="" href="{{ forum.get_absolute_url }}" class="btn btn-outline-secondary btn-sm btn-block" role="button">{{ forum.title }}</a></h5>
                            </div>               
                        </div>       
                    </div>
                    {% endfor %}
                </div>
                
                <div class="container" style="text-align: center;">
                    {% if page_obj.has_next %}
                        <a class="infinite-more-link" href="?page={{ page_obj.next_page_number }}"></a>
                    {% endif %} 
                    
                    <div class="loading" style="display: none;">
                        Loading...
                    </div>
                </div>
            </div> 
        </div>
    </div>           
</div>

{% endblock %}

{% block javascript %}
<script>
    var infinite = new Waypoint.Infinite({
        element: $('.infinite-container')[0],
        handler: function(direction) {   
        },
        offset: 'bottom-in-view',

        onBeforePageLoad: function() {
            $('.loading').show();
        },
        onAfterPageLoad: function() {
            $('.loading').hide();
        }
    });


    $(document).ready(function(e){
        $(function(){
            setTimeout(function(){
                $('.alert').slideUp(2000);
            }, 5000);
        });
    });

</script>
{% endblock %}